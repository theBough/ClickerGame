Public Class Form1
    Dim generator As New Random
    Dim randomNum As Integer
    Dim distractingButtons(100) As Button
    Dim buttonNumber As Integer = 0

    Private Sub btnPress_Click(sender As Object, e As EventArgs) Handles btnPress.Click
        randomNum = generator.Next(1, 101)
        btnPress.Left = generator.Next(playingField.Left, playingField.Right - btnPress.Width)
        btnPress.Top = generator.Next(playingField.Top, playingField.Bottom - btnPress.Height)
        If btnPress.Width > 5 Then
            btnPress.Width -= 5
        End If
        If btnPress.Height > 5 Then
            btnPress.Height -= 5
        End If
        chooseColour()
        createButton()
        btnPress.BackColor = Color.Green
        btnPress.BringToFront()
    End Sub
    Function chooseColour() As Color
        randomNum = generator.Next(1, 20)
        Select Case randomNum
            Case 1
                Return Color.Khaki
            Case 2
                Return Color.Beige
            Case 3
                Return Color.Aquamarine
            Case 4
                Return Color.LightSalmon
            Case 5
                Return Color.Olive
            Case 6
                Return Color.MediumBlue
            Case 7
                Return Color.Violet
            Case 8
                Return Color.WhiteSmoke
            Case 9
                Return Color.Yellow
            Case 10
                Return Color.Wheat
            Case 11
                Return Color.DarkBlue
            Case 12
                Return Color.SpringGreen
            Case 13
                Return Color.DarkCyan
            Case 14
                Return Color.Black
            Case 15
                Return Color.Magenta
            Case 16
                Return Color.Tomato
            Case 17
                Return Color.Purple
            Case 18
                Return Color.SaddleBrown
            Case 19
                Return Color.PaleGreen
            Case 20
                Return Color.Lime
        End Select
    End Function
    Private Sub Timer1_Tick_1(sender As Object, e As EventArgs) Handles Timer1.Tick
        playingField.BackColor = chooseColour()
    End Sub

    Sub createButton()
        distractingButtons(buttonNumber) = New Button
        With distractingButtons(buttonNumber)
            .Height = 50
            .Width = 50
            .BackColor = chooseColour()
            .Top = generator.Next(playingField.Top, playingField.Bottom - 50)
            .Left = generator.Next(playingField.Left, playingField.Right - 50)
        End With
        Me.Controls.Add(distractingButtons(buttonNumber))
        AddHandler distractingButtons(buttonNumber).MouseEnter, AddressOf buttonHandler
        distractingButtons(buttonNumber).BringToFront()
        Dim thereIsACollision As Boolean = True
        While thereIsACollision
            thereIsACollision = False
            If buttonNumber > 0 Then
                For i = 0 To buttonNumber - 1
                    While distractingButtons(buttonNumber).Bounds.IntersectsWith(distractingButtons(i).Bounds)
                        thereIsACollision = True
                        distractingButtons(buttonNumber).Top = generator.Next(playingField.Top, playingField.Bottom - 50)
                        distractingButtons(buttonNumber).Left = generator.Next(playingField.Left, playingField.Right - 50)
                    End While
                Next i
            End If
        End While
        buttonNumber += 1
    End Sub
    Sub buttonHandler(sender As Object, e As EventArgs)
        MsgBox("Sorry You lost, you are not very good at this game")

    End Sub
End Class
